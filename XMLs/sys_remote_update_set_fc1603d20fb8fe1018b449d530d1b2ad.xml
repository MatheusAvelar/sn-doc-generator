<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2025-10-27 13:59:59">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>Documenta√ß√£o de Update Sets</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value=""/>
<remote_parent_id/>
<remote_sys_id>00c1c39a0f78fe1018b449d530d1b294</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2025-10-27 13:59:58</sys_created_on>
<sys_id>fc1603d20fb8fe1018b449d530d1b2ad</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2025-10-27 13:59:58</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_script_include_213007d60f78fe1018b449d530d1b2b5</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;public&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;global.GetUpdateSetDocumentation&lt;/api_name&gt;&lt;caller_access/&gt;&lt;client_callable&gt;true&lt;/client_callable&gt;&lt;description/&gt;&lt;mobile_callable&gt;false&lt;/mobile_callable&gt;&lt;name&gt;GetUpdateSetDocumentation&lt;/name&gt;&lt;sandbox_callable&gt;false&lt;/sandbox_callable&gt;&lt;script&gt;&lt;![CDATA[var GetUpdateSetDocumentation = Class.create();
GetUpdateSetDocumentation.prototype = Object.extendsObject(AbstractAjaxProcessor, {
    getDocumentation: function() {
        var updateSetName = this.getParameter('sysparm_update_set');
        var audience = this.getParameter('sysparm_audience') || 'po';
        var userName = gs.getUserDisplayName();
        var gdt = new GlideDateTime();
        var today = gdt.getLocalDate().getByFormat('dd/MM/yyyy');

        // ===== P√°gina Inicial =====
        var homeHtml = "";
        homeHtml += "&lt;div style='text-align:center;margin-bottom:25px;padding:25px;background:#f1f8e9;border:1px solid #c5e1a5;border-radius:8px;'&gt;";
        homeHtml += "  &lt;img src='https://dev278204.service-now.com/6be4c85cc330b2107859b11ed4013140.iix' alt='Logo' style='width:300px;height:auto;margin-bottom:10px;' /&gt;";

        // T√≠tulo din√¢mico baseado no input de Cen√°rio
        homeHtml += "  &lt;h1 id='tituloPrincipal' style='margin:0;font-size:24px;'&gt;Documenta√ß√£o - ServiceNow&lt;/h1&gt;";
        homeHtml += "  &lt;p style='font-size:14px;opacity:0.9;margin-top:6px;'&gt;Gerador autom√°tico de evid√™ncias de testes e artefatos&lt;/p&gt;";
        homeHtml += "&lt;/div&gt;";

        if (!updateSetName)
            return homeHtml + "&lt;p style='color:red;text-align:center;'&gt;Nenhum Update Set informado.&lt;/p&gt;";

        // ===== Cabe√ßalho =====
        var headerHtml = "&lt;div style='background:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:15px 20px;margin-bottom:20px;'&gt;";
        headerHtml += "&lt;div style='display:flex;justify-content:space-between;flex-wrap:wrap;align-items:center;'&gt;";
        headerHtml += "&lt;h3 style='margin:0;color:#333;'&gt;]]&gt;üßæ&lt;![CDATA[ Evid√™ncia de Testes&lt;/h3&gt;";
        headerHtml += "&lt;span style='color:#777;font-size:13px;'&gt;Gerado em &lt;b&gt;" + today + "&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;";
        headerHtml += "&lt;hr style='margin:10px 0;border:none;border-top:1px solid #eee;' /&gt;";

        // Inputs e placeholders
        headerHtml += "&lt;table style='width:100%;border-collapse:collapse;font-size:14px;'&gt;";
        headerHtml += "&lt;tr&gt;&lt;td style='padding:4px;'&gt;&lt;b&gt;Projeto:&lt;/b&gt; &lt;input type='text' placeholder='Ex: Portal de Chamados' style='width:90%;border:none;border-bottom:1px solid #ccc;padding:2px;' /&gt;&lt;/td&gt;";
        headerHtml += "&lt;td style='padding:4px;'&gt;&lt;b&gt;Data:&lt;/b&gt; " + today + "&lt;/td&gt;&lt;/tr&gt;";
        headerHtml += "&lt;tr&gt;&lt;td style='padding:4px;'&gt;&lt;b&gt;Executado Por:&lt;/b&gt; " + userName + "&lt;/td&gt;";
        headerHtml += "&lt;td style='padding:4px;'&gt;&lt;b&gt;Squad:&lt;/b&gt; &lt;input type='text' placeholder='Nome da Squad' style='width:90%;border:none;border-bottom:1px solid #ccc;padding:2px;' /&gt;&lt;/td&gt;&lt;/tr&gt;";
        headerHtml += "&lt;tr&gt;&lt;td style='padding:4px;'&gt;&lt;b&gt;Ambiente de Testes:&lt;/b&gt; &lt;input type='text' placeholder='Ex: DEV / TEST' style='width:90%;border:none;border-bottom:1px solid #ccc;padding:2px;' /&gt;&lt;/td&gt;";
        headerHtml += "&lt;td style='padding:4px;'&gt;&lt;b&gt;Status:&lt;/b&gt; &lt;span style='color:#4CAF50;font-weight:bold;'&gt;Pronto&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;";

        // Input de Cen√°rio
        headerHtml += "&lt;tr&gt;&lt;td style='padding:4px;'&gt;&lt;b&gt;Cen√°rio:&lt;/b&gt; &lt;input id='inputCenario' type='text' placeholder='Descreva o cen√°rio testado' style='width:90%;border:none;border-bottom:1px solid #ccc;padding:2px;' oninput=\"(function(el){var t=document.getElementById('tituloPrincipal');var v=el.value.trim(); t.textContent = v ? 'Documenta√ß√£o - ' + v : 'Documenta√ß√£o - ServiceNow';})(this)\" onblur=\"(function(el){var t=document.getElementById('tituloPrincipal');var v=el.value.trim(); t.textContent = v ? 'Documenta√ß√£o - ' + v : 'Documenta√ß√£o - ServiceNow';})(this)\" /&gt;&lt;/td&gt;";
        headerHtml += "&lt;td style='padding:4px;'&gt;&lt;b&gt;Sistema:&lt;/b&gt; ServiceNow&lt;/td&gt;&lt;/tr&gt;";
        headerHtml += "&lt;tr&gt;&lt;td style='padding:4px;'&gt;&lt;b&gt;Story:&lt;/b&gt; &lt;input type='text' placeholder='N√∫mero da story (ex: Story-1234)' style='width:90%;border:none;border-bottom:1px solid #ccc;padding:2px;' /&gt;&lt;/td&gt;";
        headerHtml += "&lt;td style='padding:4px;'&gt;&lt;b&gt;Update Set:&lt;/b&gt; " + updateSetName + "&lt;/td&gt;&lt;/tr&gt;";
        headerHtml += "&lt;/table&gt;";

        headerHtml += "&lt;div style='margin-top:10px;'&gt;&lt;b&gt;Observa√ß√µes:&lt;/b&gt;";
        headerHtml += "&lt;textarea placeholder='Adicione observa√ß√µes relevantes...' style='width:100%;margin-top:5px;height:50px;border:1px solid #ccc;border-radius:6px;padding:6px;font-size:13px;resize:none;'&gt;&lt;/textarea&gt;&lt;/div&gt;&lt;/div&gt;";

        // ===== Agrupa itens por tipo =====
        var allowedTypesForPO = ["Script Include", "Business Rule", "UI Page", "Table", "Field Label"];
        var updatesByType = {};
        var gr = new GlideRecord('sys_update_xml');
        gr.addQuery('update_set.name', updateSetName);
        gr.orderBy('type');
        gr.query();
        while (gr.next()) {
            var type = gr.type.toString();
            if (audience == "po" &amp;&amp; allowedTypesForPO.indexOf(type) == -1) continue;
            if (!updatesByType[type]) updatesByType[type] = [];
            updatesByType[type].push(gr.getUniqueValue());
        }

        // ===== Sum√°rio e evid√™ncias =====
        var summaryHtml = "&lt;div style='background:#f1f8e9;border:1px solid #c5e1a5;border-radius:8px;padding:15px 20px;margin-bottom:25px;'&gt;";
        summaryHtml += "&lt;h3 style='margin-top:0;color:#33691e;'&gt;]]&gt;üìö&lt;![CDATA[ Sum√°rio dos Artefatos&lt;/h3&gt;&lt;ul style='list-style:none;padding-left:10px;margin:0;'&gt;";
        for (var type in updatesByType) {
            var displayType = (audience == "po") ? this.getTranslatedTypeName(type) : type;
            var anchor = type.toLowerCase().replace(/\s+/g, "_");
            summaryHtml += "&lt;li style='margin:4px 0;'&gt;&lt;a href='#" + anchor + "' style='color:#00796b;text-decoration:none;font-weight:bold;'&gt;]]&gt;üîπ&lt;![CDATA[ " + displayType + "&lt;/a&gt;&lt;/li&gt;";
        }
        summaryHtml += "&lt;/ul&gt;&lt;/div&gt;";

        var evidenciasHtml = "&lt;div id='blocoEvidencias' style='background:#fff8e1;border:1px solid #ffe082;border-radius:8px;padding:15px 20px;margin-bottom:25px;'&gt;";
        evidenciasHtml += "&lt;style&gt;#blocoEvidencias img { max-width:100%; height:auto; display:block; margin:auto; margin-bottom:10px; }&lt;/style&gt;";
        evidenciasHtml += "&lt;h3 style='margin-top:0;color:#ff6f00;'&gt;]]&gt;üñº&lt;![CDATA[Ô∏è Evid√™ncias (Imagens)&lt;/h3&gt;";
        evidenciasHtml += "&lt;p style='font-size:13px;color:#555;margin-bottom:10px;'&gt;Aqui voc√™ poder√° adicionar imagens ou evid√™ncias relacionadas ao Update Set.&lt;/p&gt;";
        evidenciasHtml += "&lt;/div&gt;";

        // ===== Bloco detalhado (sem altera√ß√£o) =====
        var blocoHtml = "";
        for (var type in updatesByType) {
            var icon = this.getIconByType(type);
            var displayType = (audience == "po") ? this.getTranslatedTypeName(type) : type;
            var anchor = type.toLowerCase().replace(/\s+/g, "_");

            blocoHtml += "&lt;div id='" + anchor + "' style='background:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:12px 16px;margin-bottom:20px;'&gt;";
            blocoHtml += "&lt;h3 style='margin:0 0 8px 0;color:#333;'&gt;" + icon + " " + displayType + "&lt;/h3&gt;&lt;ul style='list-style:none;padding-left:0;margin:0;'&gt;";

            for (var i = 0; i &lt; updatesByType[type].length; i++) {
                var grItem = new GlideRecord('sys_update_xml');
                if (grItem.get(updatesByType[type][i])) {
                    var friendlyName = this.getFriendlyName(type, grItem);
                    var description = this.getDescriptionByType(type, grItem) || (type === "Field Label" ? "Campo do formul√°rio" : "Sem coment√°rio");
                    var action = grItem.action.toString().toUpperCase();
                    var link = this.getRecordLink(grItem);

                    var actionLabel, actionColor;
                    switch (action) {
                        case 'DELETE':
                            actionLabel = 'Exclus√£o';
                            actionColor = '#F44336';
                            break;
                        case 'INSERT_OR_UPDATE':
                            actionLabel = 'Cria√ß√£o/Atualiza√ß√£o';
                            actionColor = '#FF9800';
                            break;
                        default:
                            actionLabel = 'Outro';
                            actionColor = '#9E9E9E';
                    }

                    blocoHtml += "&lt;li style='padding:8px 10px;margin-bottom:8px;border-radius:6px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.05);transition:0.2s;'&gt;";
                    blocoHtml += "&lt;div style='display:flex;justify-content:space-between;align-items:center;'&gt;&lt;b style='color:#333;'&gt;" + friendlyName + "&lt;/b&gt;";
                    blocoHtml += "&lt;span style='background:" + actionColor + ";color:white;padding:2px 8px;border-radius:12px;font-size:11px;'&gt;" + actionLabel + "&lt;/span&gt;&lt;/div&gt;";
                    blocoHtml += "&lt;div style='color:#555;font-size:12px;margin-top:4px;'&gt;" + description + "&lt;/div&gt;";
                    blocoHtml += "&lt;div style='margin-top:6px;'&gt;&lt;a href='" + link + "' target='_blank' style='color:#2196F3;font-size:12px;text-decoration:none;'&gt;]]&gt;üîó&lt;![CDATA[ Abrir artefato no ServiceNow&lt;/a&gt;&lt;/div&gt;";
                    blocoHtml += "&lt;/li&gt;";
                }
            }

            blocoHtml += "&lt;/ul&gt;&lt;div style='text-align:right;margin-top:8px;'&gt;&lt;a href='#top' style='font-size:12px;color:#00796b;text-decoration:none;'&gt;‚¨ÜÔ∏è Voltar ao topo&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;";
        }

        // ===== Script para atualizar t√≠tulo dinamicamente =====
        var scriptHtml = "&lt;script&gt;document.addEventListener('DOMContentLoaded', function(){";
        scriptHtml += "var titulo=document.getElementById('tituloPrincipal');";
        scriptHtml += "var inputCenario=document.getElementById('inputCenario');";
        scriptHtml += "if(inputCenario &amp;&amp; titulo){";
        scriptHtml += "inputCenario.addEventListener('input',function(){";
        scriptHtml += "var val=inputCenario.value.trim();";
        scriptHtml += "titulo.textContent = val ? 'Documenta√ß√£o - ' + val : '';";
        scriptHtml += "});}});&lt;/script&gt;";

        // ===== Retorno Final =====
        return "&lt;div id='top'&gt;" + homeHtml + headerHtml + summaryHtml + evidenciasHtml + blocoHtml + scriptHtml + "&lt;/div&gt;";
    },


    getDescriptionByType: function(type, grItem) {
        var description = "";
        var name = grItem.getValue('name');
        var sysIdMatch = name.match(/sys_[a-z_]+_([0-9a-f]{32})/);
        var sysId = sysIdMatch ? sysIdMatch[1] : null;

        switch (type) {
            case 'Script Include':
                if (sysId) {
                    var siGR = new GlideRecord('sys_script_include');
                    if (siGR.get(sysId)) description = siGR.getValue('description');
                }
                break;
            case 'Business Rule':
                if (sysId) {
                    var brGR = new GlideRecord('sys_script');
                    if (brGR.get(sysId)) description = brGR.getValue('description');
                }
                break;
            case 'UI Page':
                if (sysId) {
                    var uiGR = new GlideRecord('sys_ui_page');
                    if (uiGR.get(sysId)) description = uiGR.getValue('description');
                }
                break;
            case 'Table':
                if (sysId) {
                    var tblGR = new GlideRecord('sys_db_object');
                    if (tblGR.get(sysId)) description = tblGR.getValue('description');
                }
                break;
            case 'Field Label':
                description = "Campo do formul√°rio";
                break;
            default:
                description = "";
        }
        return description;
    },

    getFriendlyName: function(type, gr) {
        var name = gr.name.toString();
        var sysIdMatch = name.match(/sys_[a-z_]+_([0-9a-f]{32})/);
        var sysId = sysIdMatch ? sysIdMatch[1] : null;

        switch (type) {
            case 'Script Include':
                if (sysId) {
                    var siGR = new GlideRecord('sys_script_include');
                    if (siGR.get(sysId)) return siGR.getDisplayValue() + " (" + siGR.name + ")";
                }
                return name;
            case 'Business Rule':
                if (sysId) {
                    var brGR = new GlideRecord('sys_script');
                    if (brGR.get(sysId)) return brGR.getDisplayValue() + " (" + brGR.name + ")";
                }
                return name;
            case 'Table':
                if (sysId) {
                    var tblGR = new GlideRecord('sys_db_object');
                    if (tblGR.get(sysId)) return tblGR.getDisplayValue() + " (" + tblGR.name + ")";
                }
                return name;
            case 'UI Page':
                if (sysId) {
                    var uiGR = new GlideRecord('sys_ui_page');
                    if (uiGR.get(sysId)) return uiGR.getDisplayValue() + " (" + uiGR.name + ")";
                }
                var uGR = new GlideRecord('sys_ui_page');
                uGR.addQuery('name', name);
                uGR.query();
                if (uGR.next()) return uGR.title + " (" + name + ")";
                return name;
            case 'Field Label':
                return this.getFriendlyFieldLabel(name);
            default:
                return name;
        }
    },

    getFriendlyFieldLabel: function(updateXmlName) {
        var nameWithoutPrefix = updateXmlName.replace(/^sys_documentation_/, '');
        var lastUIndex = nameWithoutPrefix.lastIndexOf('_u_');
        var columnName = lastUIndex !== -1 ? nameWithoutPrefix.substring(lastUIndex + 1) : nameWithoutPrefix;
        columnName = columnName.replace(/_en$/, '');
        var fGR = new GlideRecord('sys_dictionary');
        fGR.addQuery('element', columnName);
        fGR.query();
        if (fGR.next()) return fGR.column_label + " (" + columnName + ")";
        return columnName;
    },

    getIconByType: function(type) {
        switch (type) {
            // ==== Back-end ====
            case 'Script Include':
                return ']]&gt;üß†&lt;![CDATA[';
            case 'Business Rule':
                return '‚öôÔ∏è';
            case 'Scheduled Script Execution': // Scheduled Job
            case 'Scheduled Script':
                return '‚è∞';
            case 'Fix Script':
                return ']]&gt;ü©π&lt;![CDATA[';
            case 'Flow':
                return ']]&gt;üåä&lt;![CDATA[';
            case 'Subflow':
                return ']]&gt;üåä&lt;![CDATA[';
            case 'Action':
                return ']]&gt;üéØ&lt;![CDATA[';
            case 'Flow Action':
                return ']]&gt;üîÅ&lt;![CDATA[';
            case 'Script Action':
                return ']]&gt;üìú&lt;![CDATA[';
            case 'Scripted REST Resource':
                return ']]&gt;üîå&lt;![CDATA[';
            case 'Scripted REST API':
                return ']]&gt;üåê&lt;![CDATA[';
            case 'REST Message':
                return ']]&gt;üì°&lt;![CDATA[';
            case 'SOAP Message':
                return ']]&gt;üß¥&lt;![CDATA[';
            case 'Transform Map':
                return ']]&gt;üîÑ&lt;![CDATA[';
            case 'Import Set Table':
                return ']]&gt;üì•&lt;![CDATA[';
            case 'Import Set Transform Map':
                return '‚ôªÔ∏è';
            case 'Data Source':
                return ']]&gt;üóÇ&lt;![CDATA[Ô∏è';
            case 'Record Producer':
                return ']]&gt;üßæ&lt;![CDATA[';
            case 'Catalog Script':
                return ']]&gt;üí¨&lt;![CDATA[';
            case 'Script Include Test':
                return ']]&gt;üß™&lt;![CDATA[';
            case 'Access Control':
                return ']]&gt;üîí&lt;![CDATA[';
            case 'ACL':
                return ']]&gt;üîê&lt;![CDATA[';
            case 'Event Registry':
                return ']]&gt;üì£&lt;![CDATA[';
            case 'Notification Email Script':
                return ']]&gt;üìß&lt;![CDATA[';
            case 'Notification':
                return ']]&gt;üì®&lt;![CDATA[';
            case 'UI Script':
                return ']]&gt;ü™∂&lt;![CDATA[';
            case 'UI Macro':
                return ']]&gt;üß©&lt;![CDATA[';
            case 'UI Formatter':
                return ']]&gt;ü™Ñ&lt;![CDATA[';
            case 'Processor':
                return '‚öôÔ∏è';

                // ==== Front-end / UI ====
            case 'UI Page':
                return ']]&gt;üåç&lt;![CDATA[';
            case 'UI Action':
                return ']]&gt;üé¨&lt;![CDATA[';
            case 'UI Policy':
                return ']]&gt;üß≠&lt;![CDATA[';
            case 'Client Script':
                return ']]&gt;üíª&lt;![CDATA[';
            case 'Form Design':
                return ']]&gt;üß±&lt;![CDATA[';
            case 'Form Layout':
                return ']]&gt;üß©&lt;![CDATA[';
            case 'Field Label':
                return ']]&gt;üè∑&lt;![CDATA[Ô∏è';
            case 'Catalog Client Script':
                return ']]&gt;üñ±&lt;![CDATA[Ô∏è';
            case 'Catalog UI Policy':
                return ']]&gt;üé®&lt;![CDATA[';
            case 'Widget':
                return ']]&gt;üß±&lt;![CDATA[';
            case 'Service Portal':
                return ']]&gt;üö™&lt;![CDATA[';
            case 'Theme':
                return ']]&gt;üé®&lt;![CDATA[';
            case 'Menu':
                return ']]&gt;üìú&lt;![CDATA[';
            case 'Module':
                return ']]&gt;üìÅ&lt;![CDATA[';
            case 'Application Menu':
                return ']]&gt;üß≠&lt;![CDATA[';
            case 'Navigation Menu':
                return ']]&gt;üó∫&lt;![CDATA[Ô∏è';
            case 'Page Route':
                return ']]&gt;üõ§&lt;![CDATA[Ô∏è';
            case 'Dashboard':
                return ']]&gt;üìä&lt;![CDATA[';
            case 'Report':
                return ']]&gt;üìà&lt;![CDATA[';
            case 'Visualization':
                return ']]&gt;üìâ&lt;![CDATA[';
            case 'UI Builder Page':
                return ']]&gt;üèó&lt;![CDATA[Ô∏è';

                // ==== Dados / Estrutura ====
            case 'Table':
                return ']]&gt;üóÉ&lt;![CDATA[Ô∏è';
            case 'Dictionary Entry':
                return ']]&gt;üìö&lt;![CDATA[';
            case 'Dictionary Override':
                return ']]&gt;üìò&lt;![CDATA[';
            case 'Field':
                return ']]&gt;üßæ&lt;![CDATA[';
            case 'Choice List':
                return ']]&gt;üî¢&lt;![CDATA[';
            case 'Reference Qualifier':
                return ']]&gt;üîó&lt;![CDATA[';
            case 'List Layout':
                return ']]&gt;üßÆ&lt;![CDATA[';
            case 'Form Section':
                return ']]&gt;üìã&lt;![CDATA[';
            case 'View':
                return ']]&gt;üëÅ&lt;![CDATA[Ô∏è';
            case 'Relationship':
                return ']]&gt;ü™¢&lt;![CDATA[';
            case 'CI Relationship':
                return ']]&gt;üî©&lt;![CDATA[';
            case 'CI Class':
                return ']]&gt;üè≠&lt;![CDATA[';

                // ==== Cat√°logo / Portal ====
            case 'Catalog Item':
                return ']]&gt;üõí&lt;![CDATA[';
            case 'Record Producer':
                return ']]&gt;üßæ&lt;![CDATA[';
            case 'Order Guide':
                return ']]&gt;üì¶&lt;![CDATA[';
            case 'Flow Designer Action':
                return '‚ö°';
            case 'Flow Designer Subflow':
                return ']]&gt;üîÑ&lt;![CDATA[';

                // ==== Workflows e Automa√ß√£o ====
            case 'Workflow':
                return ']]&gt;üîÅ&lt;![CDATA[';
            case 'Workflow Activity':
                return '‚öôÔ∏è';
            case 'Approval Definition':
                return '‚úÖ';
            case 'Approval Rule':
                return '‚òëÔ∏è';
            case 'Assignment Rule':
                return ']]&gt;üìå&lt;![CDATA[';
            case 'Notification Trigger':
                return ']]&gt;üîî&lt;![CDATA[';

                // ==== Seguran√ßa e Configura√ß√£o ====
            case 'Role':
                return ']]&gt;üß©&lt;![CDATA[';
            case 'Group':
                return ']]&gt;üë•&lt;![CDATA[';
            case 'User':
                return ']]&gt;üë§&lt;![CDATA[';
            case 'Property':
                return '‚öôÔ∏è';
            case 'System Property':
                return ']]&gt;üß≠&lt;![CDATA[';
            case 'UI Property':
                return ']]&gt;ü™ü&lt;![CDATA[';
            case 'Access Role':
                return ']]&gt;üîê&lt;![CDATA[';
            case 'Security Rule':
                return ']]&gt;üõ°&lt;![CDATA[Ô∏è';
            case 'Domain':
                return ']]&gt;üåê&lt;![CDATA[';
            case 'Domain Separation':
                return ']]&gt;üåç&lt;![CDATA[';

                // ==== Integra√ß√µes ====
            case 'Connection &amp; Credential Alias':
                return ']]&gt;üîë&lt;![CDATA[';
            case 'MID Server Script Include':
                return ']]&gt;üõ∞&lt;![CDATA[Ô∏è';
            case 'IntegrationHub':
                return ']]&gt;üîó&lt;![CDATA[';
            case 'Spoke':
                return ']]&gt;üõ†&lt;![CDATA[Ô∏è';
            case 'REST API Explorer':
                return ']]&gt;üöÄ&lt;![CDATA[';
            case 'Outbound REST Message':
                return ']]&gt;üì§&lt;![CDATA[';
            case 'Inbound REST Message':
                return ']]&gt;üì•&lt;![CDATA[';

                // ==== Outros ====
            case 'Update Set':
                return ']]&gt;üì¶&lt;![CDATA[';
            case 'Application File':
                return ']]&gt;üóÇ&lt;![CDATA[Ô∏è';
            case 'System Definition':
                return '‚öôÔ∏è';
            case 'Global UI Script':
                return ']]&gt;üåê&lt;![CDATA[';
            case 'Style Sheet':
                return ']]&gt;üé®&lt;![CDATA[';
            case 'Content Block':
                return ']]&gt;üß±&lt;![CDATA[';
            case 'Content Layout':
                return ']]&gt;üñº&lt;![CDATA[Ô∏è';
            case 'Content Theme':
                return ']]&gt;ü™∂&lt;![CDATA[';
            case 'Content Type':
                return ']]&gt;üìë&lt;![CDATA[';
            case 'Announcement':
                return ']]&gt;üì¢&lt;![CDATA[';
            case 'Knowledge Article':
                return ']]&gt;üìò&lt;![CDATA[';
            case 'SLA Definition':
                return '‚è±Ô∏è';
            case 'SLA Workflow':
                return ']]&gt;üìè&lt;![CDATA[';
            case 'Metric Definition':
                return ']]&gt;üìä&lt;![CDATA[';
            case 'Report Source':
                return ']]&gt;üìÑ&lt;![CDATA[';
            case 'Scripted REST API Resource':
                return ']]&gt;üîå&lt;![CDATA[';
            case 'Schedule':
                return ']]&gt;üìÜ&lt;![CDATA[';
            case 'Email Layout':
                return '‚úâÔ∏è';
            case 'Email Notification':
                return ']]&gt;üì®&lt;![CDATA[';
            case 'Email Template':
                return ']]&gt;üìß&lt;![CDATA[';

                // ==== Padr√£o ====
            default:
                return ']]&gt;üìÑ&lt;![CDATA[';
        }
    },

    getTranslatedTypeName: function(type) {
        var map = {
            "Script Include": "Script de Servidor",
            "Business Rule": "Regra de Neg√≥cio",
            "UI Page": "P√°gina de Interface",
            "UI Action": "Bot√£o ou A√ß√£o de Interface",
            "UI Policy": "Pol√≠tica de Interface",
            "Client Script": "Script de Cliente",
            "Table": "Tabela de Dados",
            "Field Label": "R√≥tulo de Campo",
            "Flow": "Fluxo de Automa√ß√£o",
            "Subflow": "Subfluxo",
            "Widget": "Componente de Portal",
            "Catalog Item": "Item de Cat√°logo",
            "Record Producer": "Produtor de Registro",
            "Notification": "Notifica√ß√£o",
            "Report": "Relat√≥rio",
            "Dashboard": "Painel",
            "Role": "Fun√ß√£o de Acesso",
            "Group": "Grupo de Usu√°rios",
            "Property": "Propriedade do Sistema",
            "Scripted REST API": "API REST Personalizada",
            "Transform Map": "Mapa de Transforma√ß√£o",
            "Import Set Table": "Tabela de Importa√ß√£o",
            "Access Control": "Controle de Acesso",
            "Workflow": "Fluxo de Trabalho",
            "Application Menu": "Menu de Aplica√ß√£o",
            "Module": "M√≥dulo de Navega√ß√£o",
            "UI Builder Page": "P√°gina do UI Builder",
            "Style Sheet": "Folha de Estilo (CSS)",
            "Notification Email Script": "Script de E-mail",
            "Fix Script": "Script de Corre√ß√£o",
            "REST Message": "Mensagem REST",
            "Event Registry": "Registro de Evento",
            "Dictionary Entry": "Entrada de Dicion√°rio",
            "Choice List": "Lista de Op√ß√µes",
            "Form Design": "Design de Formul√°rio",
            "Form Layout": "Layout de Formul√°rio"
        };

        return map[type] || type;
    },

    getRecordLink: function(gr) {
        var instanceUrl = gs.getProperty('doc.uri');
        var link = "";
        var nameMatch = gr.name.match(/^(.*)_([0-9a-f]{32})$/i);
        if (nameMatch) link = instanceUrl + nameMatch[1] + ".do?sys_id=" + nameMatch[2];

        return link;
    },

});]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-10-27 13:34:39&lt;/sys_created_on&gt;&lt;sys_id&gt;213007d60f78fe1018b449d530d1b2b5&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;GetUpdateSetDocumentation&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_213007d60f78fe1018b449d530d1b2b5&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-10-27 13:41:23&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;sys_es_latest_script action="INSERT_OR_UPDATE"&gt;&lt;id&gt;213007d60f78fe1018b449d530d1b2b5&lt;/id&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-10-27 13:34:39&lt;/sys_created_on&gt;&lt;sys_id&gt;ca4087d60f78fe1018b449d530d1b22c&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-10-27 13:34:39&lt;/sys_updated_on&gt;&lt;table&gt;sys_script_include&lt;/table&gt;&lt;use_es_latest&gt;true&lt;/use_es_latest&gt;&lt;/sys_es_latest_script&gt;&lt;/record_update&gt;</payload>
<payload_hash>1438187928</payload_hash>
<remote_update_set display_value="Documenta√ß√£o de Update Sets">fc1603d20fb8fe1018b449d530d1b2ad</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2025-10-27 13:59:58</sys_created_on>
<sys_id>341603d20fb8fe1018b449d530d1b2ae</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19a25e6f23f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2025-10-27 13:59:58</sys_updated_on>
<table/>
<target_name>GetUpdateSetDocumentation</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_guid>b4d10b9a4d78fe101f0516f8c13fa882</update_guid>
<update_guid_history>b4d10b9a4d78fe101f0516f8c13fa882:1438187928,d64087d6ab78fe108ea651795c1ddac6:871042602</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_page_4adfb6960f78fe1018b449d530d1b2b0</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_page"&gt;&lt;sys_ui_page action="INSERT_OR_UPDATE"&gt;&lt;category&gt;general&lt;/category&gt;&lt;client_script/&gt;&lt;description/&gt;&lt;direct&gt;false&lt;/direct&gt;&lt;endpoint/&gt;&lt;html&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide"&gt;

    &lt;g:ui_form&gt;
        &lt;div style="max-width:900px;margin:auto;padding:20px;font-family:Arial,sans-serif;"&gt;

            &lt;!-- Input nome do Update Set --&gt;
            &lt;label for="updateSetInput"&gt;&lt;b&gt;Informe o nome do Update Set:&lt;/b&gt;&lt;/label&gt;
            &lt;input type="text" id="updateSetInput" style="width:100%;padding:8px;margin-top:5px;margin-bottom:15px;
                   border-radius:6px;border:1px solid #ccc;" /&gt;

            &lt;!-- Select p√∫blico --&gt;
            &lt;label for="audienceSelect"&gt;&lt;b&gt;Selecione o p√∫blico:&lt;/b&gt;&lt;/label&gt;
            &lt;select id="audienceSelect" style="width:100%;padding:8px;margin-top:5px;margin-bottom:15px;
                    border-radius:6px;border:1px solid #ccc;"&gt;
                &lt;option value="dev"&gt;Desenvolvedor&lt;/option&gt;
                &lt;option value="po"&gt;P.O.&lt;/option&gt;
            &lt;/select&gt;

            &lt;!-- Bot√µes --&gt;
            &lt;div style="text-align:center;margin-top:15px;"&gt;
                &lt;button id="generateBtn" type="button" style="background:#4CAF50;color:#fff;padding:10px 18px;
                        border:none;border-radius:6px;cursor:pointer;transition:background 0.3s;"&gt;
                    ‚öôÔ∏è Gerar Documenta√ß√£o
                &lt;/button&gt;

                &lt;button id="downloadBtn" type="button" style="background:#FF9800;color:#fff;padding:10px 18px;
                        border:none;border-radius:6px;cursor:pointer;margin-left:10px;
                        transition:background 0.3s;"&gt;
                    ]]&gt;üíæ&lt;![CDATA[ Exportar PDF
                &lt;/button&gt;

                &lt;!-- Bot√£o de anexar imagem (inicialmente oculto) --&gt;
                &lt;button id="attachBtn" type="button" style="background:#2196F3;color:#fff;padding:10px 18px;
                        border:none;border-radius:6px;cursor:pointer;margin-left:10px;
                        transition:background 0.3s; display:none;"&gt;
                    ]]&gt;üìé&lt;![CDATA[ Anexar Imagem
                &lt;/button&gt;

                &lt;!-- Input invis√≠vel para upload --&gt;
                &lt;input type="file" id="fileInput" accept="image/*" style="display:none;" /&gt;
            &lt;/div&gt;

            &lt;hr style="margin:30px 0;border:none;border-top:2px solid #eee;" /&gt;

            &lt;!-- Resultado --&gt;
            &lt;div id="docResult" style="margin-top:20px;font-family:Arial, sans-serif; min-height:100px;"&gt;&lt;/div&gt;

            &lt;!-- Pr√©-visualiza√ß√£o das imagens --&gt;
            &lt;div id="imagePreviewContainer" style="display:flex;flex-wrap:wrap;gap:10px;margin-top:20px;"&gt;&lt;/div&gt;

        &lt;/div&gt;

        &lt;script&gt;
            // ===== Fun√ß√£o para gerar documenta√ß√£o =====
            function generateDocumentation() {
                var updateSet = document.getElementById("updateSetInput").value.trim();
                if (!updateSet) {
                    alert("Por favor, informe o nome do Update Set.");
                    return;
                }

                var audience = document.getElementById("audienceSelect").value;
                var docResult = document.getElementById("docResult");
                docResult.innerHTML = "&lt;p style='text-align:center;'&gt;&lt;em&gt;Gerando documenta√ß√£o...&lt;/em&gt;&lt;/p&gt;";

                var ga = new GlideAjax("GetUpdateSetDocumentation");
                ga.addParam("sysparm_name", "getDocumentation");
                ga.addParam("sysparm_update_set", updateSet);
                ga.addParam("sysparm_audience", audience);
                ga.getXMLAnswer(function(response) {
                    docResult.innerHTML = response;

                    // Mostra o bot√£o de anexar imagem ap√≥s gerar a documenta√ß√£o
                    document.getElementById("attachBtn").style.display = "inline-block";

                    window.scrollTo({
                        top: 0,
                        behavior: "smooth"
                    });
                });
            }

            // ===== Bot√£o "Gerar Documenta√ß√£o" =====
            document.getElementById("generateBtn").addEventListener("click", generateDocumentation);

            // ===== Bot√£o "Exportar PDF" =====
            document.getElementById("downloadBtn").addEventListener("click", function() {
                var contentDiv = document.getElementById("docResult");
                if (!contentDiv.innerHTML.trim()) {
                    alert("Nenhuma documenta√ß√£o gerada para exportar.");
                    return;
                }

                var clone = contentDiv.cloneNode(true);
                clone.querySelectorAll("input, textarea").forEach(function(el) {
                    var value = el.value || el.placeholder || "";
                    var span = document.createElement("span");
                    span.style.borderBottom = "1px solid #ccc";
                    span.style.padding = "2px 4px";
                    span.textContent = value;
                    el.parentNode.replaceChild(span, el);
                });

                var win = window.open("", "", "height=900,width=1000");
                win.document.write("&lt;html&gt;&lt;head&gt;&lt;title&gt;Documenta√ß√£o&lt;/title&gt;");
                win.document.write("&lt;style&gt;table{border-collapse:collapse;width:100%;font-family:Arial,sans-serif;} th,td{border:1px solid #ccc;padding:8px;} th{background:#f2f2f2;}&lt;/style&gt;");
                win.document.write("&lt;/head&gt;&lt;body&gt;");
                win.document.write(clone.innerHTML);
                win.document.write("&lt;/body&gt;&lt;/html&gt;");
                win.document.close();
                win.print();
            });

            // ===== Bot√£o "Anexar Imagem" =====
            document.getElementById("attachBtn").addEventListener("click", function() {
                document.getElementById("fileInput").click();
            });

            // ===== Valida√ß√£o e pr√©-visualiza√ß√£o da imagem =====
            document.getElementById("fileInput").addEventListener("change", function(event) {
                var file = event.target.files[0];
                if (!file) return;

                var extension = file.name.split(".").pop().toLowerCase();
                var validExtensions = ["jpg", "jpeg", "png", "gif"];

                if (!validExtensions.includes(extension)) {
                    alert("Somente arquivos de imagem s√£o permitidos (jpg, jpeg, png, gif).");
                    event.target.value = "";
                    return;
                }

                var container = document.createElement("div");
                container.style.marginBottom = "12px";

                var img = document.createElement("img");
                img.src = URL.createObjectURL(file);
                img.alt = file.name;
                img.style.maxWidth = "800px";
                img.style.maxHeight = "890px";
                img.style.objectFit = "cover";
                img.style.border = "1px solid #ccc";
                img.style.borderRadius = "6px";
                img.style.boxShadow = "0 2px 5px rgba(0,0,0,0.1)";
                container.appendChild(img);

                var inputText = document.createElement("input");
                inputText.type = "text";
                inputText.placeholder = "Adicione uma descri√ß√£o para esta imagem...";
                inputText.style.width = "100%";
                inputText.style.marginTop = "6px";
                inputText.style.padding = "6px";
                inputText.style.borderRadius = "4px";
                inputText.style.border = "1px solid #ccc";
                container.appendChild(inputText);

                document.getElementById("blocoEvidencias").appendChild(container);

                alert("Imagem '" + file.name + "' aceita com sucesso!");
            });
        &lt;/script&gt;

    &lt;/g:ui_form&gt;
&lt;/j:jelly&gt;]]&gt;&lt;/html&gt;&lt;name&gt;Documenta√ß√£o de Update Sets&lt;/name&gt;&lt;processing_script/&gt;&lt;sys_class_name&gt;sys_ui_page&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-10-27 13:33:44&lt;/sys_created_on&gt;&lt;sys_id&gt;4adfb6960f78fe1018b449d530d1b2b0&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;Documenta√ß√£o de Update Sets&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_page_4adfb6960f78fe1018b449d530d1b2b0&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-10-27 13:59:04&lt;/sys_updated_on&gt;&lt;/sys_ui_page&gt;&lt;sys_es_latest_script action="INSERT_OR_UPDATE"&gt;&lt;id&gt;4adfb6960f78fe1018b449d530d1b2b0&lt;/id&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-10-27 13:33:43&lt;/sys_created_on&gt;&lt;sys_id&gt;9810c7960f78fe1018b449d530d1b22a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-10-27 13:33:43&lt;/sys_updated_on&gt;&lt;table&gt;sys_ui_page&lt;/table&gt;&lt;use_es_latest&gt;true&lt;/use_es_latest&gt;&lt;/sys_es_latest_script&gt;&lt;/record_update&gt;</payload>
<payload_hash>-702975270</payload_hash>
<remote_update_set display_value="Documenta√ß√£o de Update Sets">fc1603d20fb8fe1018b449d530d1b2ad</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2025-10-27 13:59:58</sys_created_on>
<sys_id>b01603d20fb8fe1018b449d530d1b2af</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>19a25f7217c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2025-10-27 13:59:58</sys_updated_on>
<table/>
<target_name>Documenta√ß√£o de Update Sets</target_name>
<type>UI Page</type>
<update_domain>global</update_domain>
<update_guid>a3d54b9246b8fe106d44d1fd4e82bf55</update_guid>
<update_guid_history>a3d54b9246b8fe106d44d1fd4e82bf55:-702975270,a9f38f9eb578fe10fa024e05013ec2af:-1531128728,3003435e5e78fe109df8b752e1e20f05:23569192,f4108f967c78fe105cda973c1a020a5e:-984433963</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
